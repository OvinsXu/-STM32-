<!DOCTYPE html>
<html lang="zh">

<head>
    <title>温湿度</title>
    <meta charset="utf-8">
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
</head>


<body>
    
    <h3>实时温湿度</h3>
    <div id="lblResponse" style="color: blue;margin: center;"></div>
    <hr>
    <div id="opt">
        <button id="btn_add">保存到数据库</button>
        <button id="btn_rm">删除</button>
    </div>
    <p>(5分钟自动保存一次数据)</p>
    <h3>数据库数据</h3>

    <div>
        <table id="Vue_div">
            <tr>
                <th>序号</th>
                <th>温度</th>
                <th>湿度</th>
            </tr>
            <tr v-for="item in items" :key="item._id">
                <td>{{item._id}}</td>
                <td>{{item.temp}}</td>
                <td>{{item.humi}}</td>
            </tr>
        </table>
    </div>

</body>
<script type="text/javascript">
    new Vue({
        el: '#Vue_div',
        data: {
            items: data.sqlData
        }   
        $(document).ready(function () {
            setInterval(function () {
                $.ajax({
                    url: 'http://localhost:3000/get',
                    data: '{}',
                    dataType: "json",
                    type: 'POST',
                    success: function (data) {
                        $('#lblResponse').html("温度:" + data.rtData.temp + "<br>湿度:" + data.rtData.humi);


                    },
                    error: function (xhr, status, error) {
                        console.log('Error: ' + error.message);
                        $('#lblResponse').html('Error connecting to the server.');
                    },
                });
            }, 5000)

        });

    });
</script>

</html>